import{x as D,u as fe,q as be,y as ge,i as ve,z as he,_ as Ce}from"./index.140309e9.js";/* empty css              *//* empty css               *//* empty css               *//* empty css                *//* empty css               *//* empty css               *//* empty css              *//* empty css                */import{c as F,S as ye}from"./sortable.esm.6d838f6a.js";/* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css              *//* empty css               */import{d as ke,e as k,r as Te,c as E,w as xe,a_ as ze,bL as Be,B as r,C,aH as e,aG as a,u as d,aL as p,aM as f,F as b,aJ as q,aI as O,aD as B,D as De,bn as Ie,aU as $,n as Ve,b3 as we,b4 as Se,bB as Fe,bM as Ee,bN as $e,bC as Ue,b9 as Ae,bK as Le,ab as Ne,aV as Me,b8 as Pe,bj as Re,bk as qe,bl as Oe,b6 as je,bO as Ge,bG as He,bD as Je}from"./arco.bbdacfc8.js";import{u as Ke}from"./loading.b4b50533.js";import"./chart.6ce23b19.js";import"./vue.67b87df8.js";function Qe(m){return D.post("/api/user/admin/query/list",{...m})}function We(m){return D.post(`/api/user/admin/block/${m}`)}function Xe(m){return D.post(`/api/user/admin/unblock/${m}`)}function Ye(m,T){return D.post(`/api/user/admin/role/${m}`,{role:T})}const Ze={class:"container"},ea={class:"action-icon"},aa={class:"action-icon"},ta={id:"tableSetting"},na={style:{"margin-right":"4px",cursor:"move"}},oa={class:"title"},sa={key:0,class:"circle"},la={key:1,class:"circle pass"},ia={name:"ManageUser"},ua=ke({...ia,setup(m){const T=()=>({_id:"",username:"",contentType:"",filterType:"",createdTime:[],status:""}),{loading:j,setLoading:U}=Ke(!0),{t:u}=fe(),A=k([]),l=k(T()),g=k([]),x=k([]),I=k("medium"),z={pageCurrent:1,pageSize:20},y=Te({...z}),G=E(()=>[{name:u("searchTable.size.mini"),value:"mini"},{name:u("searchTable.size.small"),value:"small"},{name:u("searchTable.size.medium"),value:"medium"},{name:u("searchTable.size.large"),value:"large"}]),H=E(()=>[{title:u("searchTable.columns.index"),dataIndex:"index",slotName:"index"},{title:"\u7528\u6237id",dataIndex:"_id"},{title:"\u7528\u6237\u540D",dataIndex:"username"},{title:"\u89D2\u8272",dataIndex:"role"},{title:"\u6587\u7AE0\u6570",dataIndex:"note_count",sortable:{sorter:!0,sortDirections:["descend"]}},{title:"\u88AB\u559C\u6B22",dataIndex:"be_liked_count",sortable:{sorter:!0,sortDirections:["descend"]}},{title:"\u6CE8\u518C\u65F6\u95F4",dataIndex:"created"},{title:u("searchTable.columns.status"),dataIndex:"status",slotName:"status"},{title:u("searchTable.columns.operations"),dataIndex:"operations",slotName:"operations"}]),J=E(()=>[{label:u("searchTable.form.status.normal"),value:"normal"},{label:u("searchTable.form.status.deleted"),value:"abnormal"},{label:u("searchTable.form.status.blocked"),value:"blocked"}]),v=async(o={pageCurrent:1,pageSize:20})=>{U(!0);try{const n=await Qe(o);A.value=n.list,y.pageCurrent=o.pageCurrent,y.total=n.totalCount}catch{}finally{U(!1)}},L=()=>{v({pageCurrent:z.pageCurrent,pageSize:z.pageSize,...l.value})},K=o=>{v({...z,pageCurrent:o})},Q=(o,n,c)=>{var i,s;n.type==="sorter"&&v({pageCurrent:n.page,pageSize:n.pageSize,sort:[{field:(i=n.sorter)==null?void 0:i.field,order:(s=n.sorter)==null?void 0:s.direction}],...l.value})};v();const W=()=>{l.value=T()},X=(o,n)=>{I.value=o},Y=(o,n,c)=>{o?g.value.splice(c,0,n):g.value=x.value.filter(i=>i.dataIndex!==n.dataIndex)},N=(o,n,c,i=!1)=>{const s=i?F(o):o;return n>-1&&c>-1&&s.splice(n,1,s.splice(c,1,s[n]).pop()),s},Z=o=>{o&&Ve(()=>{const n=document.getElementById("tableSetting");new ye(n,{onEnd(c){const{oldIndex:i,newIndex:s}=c;N(g.value,i,s),N(x.value,i,s)}})})};return xe(()=>H.value,o=>{g.value=F(o),g.value.forEach((n,c)=>{n.checked=!0}),x.value=F(g.value)},{deep:!0,immediate:!0}),(o,n)=>{const c=ze("Breadcrumb"),i=we,s=Se,_=Fe,ee=Ee,ae=$e,V=Ue,te=Ae,M=Le,ne=Ne,h=Me,P=be,oe=Pe,w=Re,se=ge,le=qe,ie=Oe,ue=ve,ce=he,re=je,R=Ge,de=He,pe=Je,me=Be("permission");return r(),C("div",Ze,[e(c,{items:["\u7528\u6237\u7BA1\u7406","\u5217\u8868"]}),e(pe,{class:"general-card",title:"\u7528\u6237\u7BA1\u7406"},{default:a(()=>[e(V,null,{default:a(()=>[e(_,{flex:1},{default:a(()=>[e(te,{model:l.value,"label-col-props":{span:6},"wrapper-col-props":{span:18},"label-align":"left"},{default:a(()=>[e(V,{gutter:16},{default:a(()=>[e(_,{span:8},{default:a(()=>[e(s,{field:"_id",label:"\u7528\u6237id"},{default:a(()=>[e(i,{modelValue:l.value._id,"onUpdate:modelValue":n[0]||(n[0]=t=>l.value._id=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237id"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:8},{default:a(()=>[e(s,{field:"username",label:"\u7528\u6237\u540D"},{default:a(()=>[e(i,{modelValue:l.value.username,"onUpdate:modelValue":n[1]||(n[1]=t=>l.value.username=t),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:8},{default:a(()=>[e(s,{field:"createdTime",label:o.$t("searchTable.form.createdTime")},{default:a(()=>[e(ee,{modelValue:l.value.createdTime,"onUpdate:modelValue":n[2]||(n[2]=t=>l.value.createdTime=t),style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(_,{span:8},{default:a(()=>[e(s,{field:"status",label:o.$t("searchTable.form.status")},{default:a(()=>[e(ae,{modelValue:l.value.status,"onUpdate:modelValue":n[3]||(n[3]=t=>l.value.status=t),options:d(J),placeholder:o.$t("searchTable.form.selectDefault")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(M,{style:{height:"84px"},direction:"vertical"}),e(_,{flex:"86px",style:{"text-align":"right"}},{default:a(()=>[e(oe,{direction:"vertical",size:18},{default:a(()=>[e(h,{type:"primary",onClick:L},{icon:a(()=>[e(ne)]),default:a(()=>[p(" "+f(o.$t("searchTable.form.search")),1)]),_:1}),e(h,{onClick:W},{icon:a(()=>[e(P)]),default:a(()=>[p(" "+f(o.$t("searchTable.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(M,{style:{"margin-top":"0"}}),e(V,{style:{"margin-bottom":"16px"}},{default:a(()=>[e(_,{span:12}),e(_,{span:12,style:{display:"flex","align-items":"center","justify-content":"end"}},{default:a(()=>[e(w,{content:o.$t("searchTable.actions.refresh")},{default:a(()=>[b("div",{class:"action-icon",onClick:L},[e(P,{size:"18"})])]),_:1},8,["content"]),e(ie,{onSelect:X},{content:a(()=>[(r(!0),C(q,null,O(d(G),t=>(r(),B(le,{key:t.value,value:t.value,class:De({active:t.value===I.value})},{default:a(()=>[b("span",null,f(t.name),1)]),_:2},1032,["value","class"]))),128))]),default:a(()=>[e(w,{content:o.$t("searchTable.actions.density")},{default:a(()=>[b("div",ea,[e(se,{size:"18"})])]),_:1},8,["content"])]),_:1}),e(w,{content:o.$t("searchTable.actions.columnSetting")},{default:a(()=>[e(R,{trigger:"click",position:"bl",onPopupVisibleChange:Z},{content:a(()=>[b("div",ta,[(r(!0),C(q,null,O(x.value,(t,_e)=>(r(),C("div",{key:t.dataIndex,class:"setting"},[b("div",na,[e(ce)]),b("div",null,[e(re,{modelValue:t.checked,"onUpdate:modelValue":S=>t.checked=S,onChange:S=>Y(S,t,_e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),b("div",oa,f(t.title==="#"?"\u5E8F\u5217\u53F7":t.title),1)]))),128))])]),default:a(()=>[b("div",aa,[e(ue,{size:"18"})])]),_:1})]),_:1},8,["content"])]),_:1})]),_:1}),e(de,{"row-key":"id",loading:d(j),pagination:y,columns:g.value,data:A.value,bordered:!1,size:I.value,onChange:Q,onOnPageChange:K},{index:a(({rowIndex:t})=>[p(f(t+1+(y.pageCurrent-1)*y.pageSize),1)]),status:a(({record:t})=>[t.status==="offline"?(r(),C("span",sa)):(r(),C("span",la)),p(" "+f(o.$t(`searchTable.form.status.${t.status}`)),1)]),operations:a(({record:t})=>[e(h,{type:"text",size:"small"},{default:a(()=>[p(f(o.$t("searchTable.columns.operations.view")),1)]),_:1}),Ie((r(),B(R,{trigger:"click",placement:"top"},{content:a(()=>[t.status==="normal"?(r(),B(h,{key:0,type:"text",size:"small",onClick:async()=>{await d(We)(t._id),d($).success("\u5C01\u7981\u6210\u529F"),v()}},{default:a(()=>[p(" \u5C01\u7981 ")]),_:2},1032,["onClick"])):(r(),B(h,{key:1,type:"text",size:"small",onClick:async()=>{await d(Xe)(t._id),d($).success("\u89E3\u5C01\u6210\u529F"),v()}},{default:a(()=>[p(" \u89E3\u5C01 ")]),_:2},1032,["onClick"])),e(h,{type:"text",size:"small",onClick:async()=>{await d(Ye)(t._id,t.role==="admin"?"user":"admin"),d($).success("\u8BBE\u7F6E\u6210\u529F"),v()}},{default:a(()=>[p(" \u8BBE\u4E3A "+f(t.role==="admin"?"\u7528\u6237":"\u7BA1\u7406\u5458"),1)]),_:2},1032,["onClick"])]),default:a(()=>[e(h,{type:"text",size:"small"},{default:a(()=>[p(" \u8BBE\u7F6E ")]),_:1})]),_:2},1024)),[[me,["admin"]]])]),_:1},8,["loading","pagination","columns","data","size"])]),_:1})])}}});const Va=Ce(ua,[["__scopeId","data-v-ef0c0d7b"]]);export{Va as default};
